---
title: 通过 REST API 转换 .docx
tags:
  - type: start
  - type: beta
meta:
    title: DOCX REST API | Tiptap 转换
    description: 通过我们的文档学习如何通过 REST API 集成 docx 文件的导入和导出功能。
    category: 转换
---

import { Callout } from '@/components/ui/Callout'
import { Requirements, RequirementItem } from '@/components/Requirements'

<Requirements>
    <RequirementItem label="1. Activate trial or subscribe">
        开始您的 [免费试用](https://cloud.tiptap.dev/v2?trial=true) 或在您的账户内 [订阅入门计划](https://cloud.tiptap.dev/v2/billing)。
    </RequirementItem>
    <RequirementItem label="2. 配置转换应用">
       要使用 Convert REST API，请从 [您的仪表盘](https://cloud.tiptap.dev/v2/cloud/convert) 获取您的应用 ID 和转换密钥。
    </RequirementItem>
</Requirements>

`DOCX` 文档转换 API 支持将 `docx` 文件转换为及从 Tiptap 的 `JSON` 格式。

<Callout title="查看 Postman 集合" variant="hint">
    您还可以通过访问我们的 [Postman 集合](https://www.postman.com/docking-module-explorer-14290287/workspace/tiptap-collaboration-public/collection/33042171-cc186a66-df41-4df8-9c6e-e91b20deffe5?action=share&creator=32651125) 来实验文档转换 API。
</Callout>


## 导入 DOCX

`POST /v2/convert/import`

`/v2/convert/import` 端点将 `docx` 文件转换为 Tiptap 的 JSON 格式。用户可以将文档 `POST` 到此端点，并使用各种参数自定义在转换过程中如何处理不同的文档元素。

### 示例 (cURL)
```bash
curl -X POST "https://api.tiptap.dev/v2/convert/import" \
    -H "Authorization: Bearer YOUR_TOKEN" \
    -H "X-App-Id: YOUR_APP_ID" \
    -F "file=@/path/to/your/file.docx" \
    -F "imageUploadCallbackUrl=https://your-image-upload-endpoint.com" \
    -F "prosemirrorNodes={\"nodeKey\":\"nodeValue\"}" \
    -F "prosemirrorMarks={\"markKey\":\"markValue\"}"
```

<Callout title="需要订阅" variant="warning">
    此端点需要有效的 Tiptap 订阅。有关更多详细信息，请查看我们的 [定价页面](https://tiptap.dev/pricing)。
</Callout>

### 必需的头部

| 名称            | 描述                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `Authorization` | 用于验证请求的 JWT 令牌。示例: `Bearer your-jwt-token`                                                                     |
| `X-App-Id`      | 来自协作设置页面的 Convert 应用 ID: [https://cloud.tiptap.dev/convert-settings](https://cloud.tiptap.dev/convert-settings) |

### 请求体

| 名称                     | 类型             | 描述                                                                                                                  |
| ------------------------ | ---------------- | --------------------------------------------------------------------------------------------------------------------- |
| `file`                   | `File`           | 要转换的文件                                                                                                            |
| `imageUploadCallbackUrl` | `string`         | 上传文档中遇到的图像的回调端点，[查看更多信息](#image-uploading)                                                     |
| `prosemirrorNodes`       | `Object string`  | 转换的自定义节点映射，[查看更多信息](/conversion/import-export/docx/custom-node-conversion)。                      |
| `prosemirrorMarks`       | `Object string`  | 转换的自定义标记映射，[查看更多信息](/conversion/import-export/docx/custom-mark-conversion)                      |
| `verbose`                | `string \| number` | 配置属性，帮助您控制导入过程中诊断输出的详细级别，尤其适用于调试或深入了解转换过程。[详见Verbose output](#import-verbose-output) |

### 导入详细输出 (Import verbose output)

DOCX 导入扩展提供了一个 `verbose` 配置属性，帮助您控制导入过程中诊断输出的详细级别。此功能对调试或深入了解转换过程非常有用。

`verbose` 属性是一个位掩码数字，决定输出哪类日志消息。扩展使用以下级别：

| 值     | 级别     | 描述                       |
|-------|---------|----------------------------|
| 1     | `log`   | 一般信息日志                |
| 2     | `warn`  | 警告                       |
| 4     | `error` | 错误                       |

<Callout title="Verbose 位掩码">
  您可以通过将值相加来组合级别。例如，`verbose: 3` 将启用 `log` (1) 和 `warn` (2) 消息。
</Callout>

详细输出会在返回结果中除了 `data` 属性外，还包含一个 `logs` 属性，其中包括 `info`、`warn` 和 `error`，每个都是对应日志类别的数组。

```js
{
  "data": {
    "content": {
        // Tiptap JSON
    }
  },
  "logs": {
    "info": [],
    "warn": [
      {
        "message": "Image file not found in media files",
        "fileName": "image1.gif",
        "availableMediaFiles": []
      }
    ],
    "error": [
      {
        "message": "Image upload failed: General error",
        "fileName": "image1.gif",
        "url": "https://your-image-upload-endpoint.com",
        "error": "Unable to connect. Is the computer able to access the url?",
        "context": "uploadImage general error"
      }
    ]
  }
}
```

### 自定义节点和标记映射

您可以通过在请求体中分别指定 `prosemirrorNodes` 和 `prosemirrorMarks` 来覆盖导入期间使用的默认 `node/mark` 类型。如果您的编辑器使用自定义的 `nodes/marks`，并且希望导入的 `JSON` 使用这些内容，则需要提供这些。

例如，如果您的架构使用一个名为 `textBlock` 的自定义节点类型，而不是默认的段落，您可以在请求体中包含 `"{\"textBlock\":\"paragraph\"}"`。

您还可以类似地调整标题、列表、加粗或斜体等标记。

#### 默认节点

| 名称             | 描述                                                          |
| ---------------- | ------------------------------------------------------------- |
| `paragraph`      | 定义段落转换使用的 prosemirror 类型                           |
| `heading`        | 定义标题转换使用的 prosemirror 类型                           |
| `blockquote`     | 定义引用转换使用的 prosemirror 类型                           |
| `codeblock`      | 定义代码块转换使用的 prosemirror 类型                         |
| `bulletlist`     | 定义无序列表转换使用的 prosemirror 类型                       |
| `orderedlist`    | 定义有序列表转换使用的 prosemirror 类型                       |
| `listitem`       | 定义列表项转换使用的 prosemirror 类型                         |
| `hardbreak`      | 定义硬换行转换使用的 prosemirror 类型                         |
| `horizontalrule` | 定义水平线转换使用的 prosemirror 类型                         |
| `table`          | 定义表格转换使用的 prosemirror 类型                           |
| `tablecell`      | 定义表格单元格转换使用的 prosemirror 类型                     |
| `tableheader`    | 定义表格头部转换使用的 prosemirror 类型                       |
| `tablerow`       | 定义表格行转换使用的 prosemirror 类型                         |
| `image`          | 定义图片转换使用的 prosemirror 标记                           |

#### 默认标记

| 名称             | 描述                                                          |
| ---------------- | ------------------------------------------------------------- |
| `bold`           | 定义粗体转换使用的 prosemirror 标记                           |
| `italic`         | 定义斜体转换使用的 prosemirror 标记                           |
| `underline`      | 定义下划线转换使用的 prosemirror 标记                         |
| `strikethrough`  | 定义删除线转换使用的 prosemirror 标记                         |
| `link`           | 定义链接转换使用的 prosemirror 标记                           |
| `code`           | 定义代码转换使用的 prosemirror 标记                           |


## 导出 DOCX

`POST /v2/convert/export`

`/v2/convert/export` 端点将 Tiptap 文档转换为 `DOCX` 格式。用户可以将文档 `POST` 到此端点，并使用各种参数自定义在转换过程中如何处理不同的文档元素。

<Callout title="导出自定义支持" variant="info">
    `/v2/convert/export` 端点不支持自定义节点转换，因为函数无法序列化，但它支持 [自定义样式覆盖](/conversion/import-export/docx/export-styles)。如果您希望在您自己的服务器上转换文档以拥有此选项，可以按照 [服务器端导出指南](/conversion/import-export/docx/editor-export#server-side-export)进行操作。
</Callout>

### 示例 (cURL)
```bash
curl --output example.docx -X POST https://api.tiptap.dev/v2/convert/export \
    -H "Authorization: Bearer <your-jwt-token>" \
    -H "X-App-Id: <your-app-id>" \
    -F 'doc={"type":"doc","content":[{"type":"paragraph","attrs":{"textAlign":"left"},"content":[{"type":"text","text":"欢迎来到我们编辑器的演示，这里展示了导出多种格式选项到 DOCX 的能力，确保您的内容在 Word 中保持其预期的外观。"}]}]}' \
    -F 'exportType=blob' \
    -F 'styleOverrides={}'
```

<Callout title="需要订阅" variant="warning">
    此端点需要有效的 Tiptap 订阅。有关更多详细信息，请查看我们的 [定价页面](https://tiptap.dev/pricing)。
</Callout>

### 必需的头部

| 名称            | 描述                                                                                                                                     |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `Authorization` | 用于验证请求的 JWT 令牌。示例: `Bearer your-jwt-token`                                                                     |
| `X-App-Id`      | 来自协作设置页面的 Convert 应用 ID: [https://cloud.tiptap.dev/convert-settings](https://cloud.tiptap.dev/convert-settings) |

### 请求体

| 名称             | 类型     | 描述               | 默认值     |
| ---------------- | -------- | ------------------ | ---------- |
| `doc`            | `String` | Tiptap 的 JSON     | `N/A`      |
| `exportType`     | `string` | 预期的导出类型     | `blob`     |
| `styleOverrides` | `Object` | 样式覆盖           | `{}`       |
| `pageSize`       | `Object` | 页面尺寸配置       | `undefined`|
| `pageMargins`    | `Object` | 页面边距配置       | `undefined`|
| `headers`        | `Object` | 页面页眉配置       | `undefined`|
| `footers`        | `Object` | 页面页脚配置       | `undefined`|

#### 页面尺寸配置（Page Size Configuration）

`pageSize` 对象允许您自定义导出 DOCX 文档的尺寸：

| 属性    | 类型     | 描述                                                                                 | 默认值       |
| ------- | -------- | ------------------------------------------------------------------------------------ | ------------ |
| `width` | `string` | 页面宽度。必须是正数，后跟有效单位（cm、in、pt、pc、mm、px）。                       | `"21.0cm"`   |
| `height`| `string` | 页面高度。必须是正数，后跟有效单位（cm、in、pt、pc、mm、px）。                       | `"29.7cm"`   |

**带自定义页面尺寸的示例 cURL：**
```bash
curl --output example.docx -X POST https://api.tiptap.dev/v2/convert/export \
    -H "Authorization: Bearer <your-jwt-token>" \
    -H "X-App-Id: <your-app-id>" \
    -F 'doc={"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"Document with custom page size"}]}]}' \
    -F 'exportType=blob' \
    -F 'pageSize={"width":"21.0cm","height":"29.7cm"}'
```

#### 页面边距配置（Page Margins Configuration）

`pageMargins` 对象允许您自定义导出 DOCX 文档的边距：

| 属性   | 类型     | 描述                                                                                                                   | 默认值     |
| ------ | -------- | ---------------------------------------------------------------------------------------------------------------------- | ---------- |
| `top`  | `string` | 页面上边距。可为负数。必须是数字，后跟有效单位（cm、in、pt、pc、mm、px）。                                              | `"1.0cm"`  |
| `bottom`| `string`| 页面下边距。可为负数。必须是数字，后跟有效单位（cm、in、pt、pc、mm、px）。                                              | `"1.0cm"`  |
| `left` | `string` | 页面左边距。必须是正数，后跟有效单位（cm、in、pt、pc、mm、px）。                                                        | `"1.0cm"`  |
| `right`| `string` | 页面右边距。必须是正数，后跟有效单位（cm、in、pt、pc、mm、px）。                                                        | `"1.0cm"`  |

**带自定义页面边距的示例 cURL：**
```bash
curl --output example.docx -X POST https://api.tiptap.dev/v2/convert/export \
    -H "Authorization: Bearer <your-jwt-token>" \
    -H "X-App-Id: <your-app-id>" \
    -F 'doc={"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"Document with custom margins"}]}]}' \
    -F 'exportType=blob' \
    -F 'pageMargins={"top":"2.0cm","bottom":"2.0cm","left":"1.5cm","right":"1.5cm"}'
```

#### 页眉和页脚配置（Headers and footers）

`headers` 和 `footers` 对象允许您配置导出 DOCX 的页眉和页脚选项。

<Callout title="团队许可证要求">
    要在 REST API 中使用页眉和页脚，您必须拥有 `Team` 许可证。
</Callout>

##### 页眉配置（Headers Configuration）

`headers` 对象允许您自定义导出 DOCX 文档的页眉：

| 属性                   | 类型     | 描述                                              |
| ---------------------- | -------- | ------------------------------------------------- |
| `evenAndOddHeaders`    | `boolean`| 是否为奇数页和偶数页使用不同的页眉                 |
| `default`              | `string` | 标准默认页眉（所有页使用）或启用 `evenAndOddHeaders` 时奇数页页眉 |
| `first`                | `string` | 启用“首页不同页眉”选项时首页的页眉                  |
| `even`                 | `string` | 启用 `evenAndOddHeaders` 选项时偶数页的页眉         |

<Callout title="限制">
    由于 API 调用无法正确序列化非常复杂的对象或函数，页眉配置限制为纯文本字符串，我们会为您转换为无样式的标准 DOCX 页眉。
</Callout>

**带自定义页眉的示例 cURL：**
```bash
curl --output example.docx -X POST https://api.tiptap.dev/v2/convert/export \
    -H "Authorization: Bearer <your-jwt-token>" \
    -H "X-App-Id: <your-app-id>" \
    -F 'doc={"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"Document with custom headers"}]}]}' \
    -F 'exportType=blob' \
    -F 'headers={"evenAndOddHeaders":true,"default":"Default Header","first":"First Page Header","even":"Even Page Header"}'
```

#### 页脚配置（Footers Configuration）

`footers` 对象允许您自定义导出 DOCX 文档的页脚：

| 属性                   | 类型     | 描述                                              |
| ---------------------- | -------- | ------------------------------------------------- |
| `evenAndOddFooters`    | `boolean`| 是否为奇数页和偶数页使用不同的页脚                |
| `default`              | `string` | 标准默认页脚（所有页使用）或启用 `evenAndOddFooters` 时奇数页页脚 |
| `first`                | `string` | 启用“首页不同页脚”选项时首页的页脚                 |
| `even`                 | `string` | 启用 `evenAndOddFooters` 选项时偶数页的页脚        |

<Callout title="限制">
    由于 API 调用无法正确序列化非常复杂的对象或函数，页脚配置限制为纯文本字符串，我们会为您转换为无样式的标准 DOCX 页脚。
</Callout>

**带自定义页脚的示例 cURL：**
```bash
curl --output example.docx -X POST https://api.tiptap.dev/v2/convert/export \
    -H "Authorization: Bearer <your-jwt-token>" \
    -H "X-App-Id: <your-app-id>" \
    -F 'doc={"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"Document with custom footers"}]}]}' \
    -F 'exportType=blob' \
    -F 'footers={"evenAndOddFooters":true,"default":"Default Footer","first":"First Page Footer","even":"Even Page Footer"}'
```