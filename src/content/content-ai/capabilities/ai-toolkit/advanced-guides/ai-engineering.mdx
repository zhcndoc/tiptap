---
title: 使用 AI 工具包进行 AI 工程
meta:
  title: AI 工程指南 | Tiptap 内容 AI
  description: 学习如何在各种场景下选择最佳 AI 模型和提示语，与 AI 工具包配合使用。
  category: 内容 AI
---

通过为每种情况选择最佳的 AI 模型和提示语，充分发挥 AI 工具包的优势。

## 选择 AI 模型

AI 工具包的工具设计为可与任何支持函数调用的 AI 模型配合使用。它们已在多种来自不同 AI 提供商的模型上进行过测试。

选择合适 AI 模型的一个关键区别是你是否需要构建一个[智能体（agent）或工作流](https://www.anthropic.com/engineering/building-effective-agents)：

- AI 智能体接收一个任务，并独立朝该任务推进，在每一步决定接下来执行什么操作。例如：[AI 聊天助手](/content-ai/capabilities/ai-toolkit/guides/ai-agent-chatbot)
- 在 AI 工作流中，AI 执行一个或多个预定义的操作，但不会选择下一步操作。这种情况出现在[简单的 AI 内容生成](/content-ai/capabilities/ai-toolkit/guides/inline-edits)或自动补全中。

### 适合智能体任务的最佳模型

对于复杂的智能体 AI 助手（如[AI 智能体聊天机器人](/content-ai/capabilities/ai-toolkit/guides/ai-agent-chatbot)指南中的示例），推荐使用具有先进工具调用能力的前沿模型。特别地，以下模型表现优异：

- OpenAI 模型：GPT-5、GPT-5 mini、GPT-5.1、GPT-5.2
- Anthropic 模型：Claude Opus 4.5、Claude Sonnet 4.5、Claude Haiku 4.5
- Google 模型：Gemini 3 Pro、Gemini 3 Flash
- Moonshot 模型：Kimi-K2
- xAI 模型：Grok 4.1 Fast
- Z.ai 模型：GLM-4.7
- Mistral 模型：Mistral Large、Mistral Medium

### 适合智能体任务的经济型模型

如果你有智能体文档编辑的需求，但优先考虑成本控制，可以选择仍支持函数调用的较小模型。特别可以考虑以下模型：

- Claude Haiku 4.5（Anthropic）
- GPT-5 mini（OpenAI）
- Gemini 3 Flash（Google）
- Mistral Medium 3.1（Mistral）

### 非智能体工作流的模型选择

并非所有文档编辑的 AI 用例都是智能体类型，有时你只是需要 AI 生成内容并插入文档。大量经济型模型适合此用途。比如前文提到的那些。

### 是否应启用推理能力？

根据我们的内部测试，开启推理对文档编辑任务的准确度和性能没有明显提升。由于推理增加了 token 消耗和延迟，**建议关闭推理或保持最低配置**，除非你的 AI 智能体需要推理用于其他目的（例如任务规划或复杂数学问题求解）。

例如，对于 AI 工具包推荐的 GPT-5 配置是将 `reasoning` 参数设置为 `'minimal'`。

关于 Gemini 3 Pro 和 Gemini 3 Flash，我们发现将推理设置为 minimal 后，响应更快且准确度相当。

## 设计合适的提示语

你可以通过提供自定义系统提示语来调整 AI 模型的行为和内容生成方式。

```ts
// app/api/chat/route.ts
import { openai } from '@ai-sdk/openai'
import { toolDefinitions } from '@tiptap-pro/ai-toolkit-ai-sdk'
import { createAgentUIStreamResponse, ToolLoopAgent, UIMessage } from 'ai'

export async function POST(req: Request) {
  const { messages }: { messages: UIMessage[] } = await req.json()

  const agent = new ToolLoopAgent({
    model: openai('gpt-5-mini'),
    instructions: `你是一个以莎士比亚风格编辑富文本文件的助手。
你应以莎士比亚风格回复，并且在编辑文档时，
你生成并添加到文档中的内容都应写成莎士比亚戏剧的风格。`,
    tools: toolDefinitions(),
    providerOptions: {
      openai: {
        reasoningEffort: 'minimal',
      },
    },
  })

  return createAgentUIStreamResponse({
    agent,
    uiMessages: messages,
  })
}
```

在系统提示中不需要提及 AI 模型有哪些工具可用。因为它们已经包含在工具定义中，AI 模型会自动识别。

不过，在系统提示里你可以按名称引用[可用工具](/content-ai/capabilities/ai-toolkit/agents/tools)，这样你可以指导 AI 模型如何以及何时使用工具，并引导它变得更健谈、有创造力或更细致。

```ts
// app/api/chat/route.ts
import { openai } from '@ai-sdk/openai'
import { toolDefinitions } from '@tiptap-pro/ai-toolkit-ai-sdk'
import { createAgentUIStreamResponse, ToolLoopAgent, UIMessage } from 'ai'

export async function POST(req: Request) {
  const { messages }: { messages: UIMessage[] } = await req.json()

  const agent = new ToolLoopAgent({
    model: openai('gpt-5-mini'),
    instructions: `你是一个可以编辑富文本文档的助手。
在调用类似 tiptapEdit 这样的文档编辑工具之前，
应该先阅读文档，了解内容和上下文。
接着，应通过非常详细的逐步描述，告知用户你将采取的文档编辑方案。
只有在详细规划后，才调用文档编辑工具。`,
    tools: toolDefinitions(),
    providerOptions: {
      openai: {
        reasoningEffort: 'minimal',
      },
    },
  })

  return createAgentUIStreamResponse({
    agent,
    uiMessages: messages,
  })
}
```

我们推荐以下资源帮助你深入学习提示工程和AI工程：

- [Anthropic 提示工程指南](https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview)
- [GPT-5 提示指南](https://cookbook.openai.com/examples/gpt-5/gpt-5_prompting_guide)
- [OpenAI 提示工程指南](https://platform.openai.com/docs/guides/prompt-engineering)
- [智能体构建实用指南](https://cdn.openai.com/business-guides-and-resources/a-practical-guide-to-building-agents.pdf)

## 提升速度和延迟

为了提升 AI 工具包的响应速度，可以采用以下策略：

### 实现响应流式传输

将内容以流的形式呈现到编辑器，使用户感觉响应更快。请参阅[工具流式传输指南](/content-ai/capabilities/ai-toolkit/guides/tool-streaming)进行实现。

### 选择更快的模型或提供商

选择模型时，注意其速度和延迟。可以参考如[Artificial Analysis](https://artificialanalysis.ai/#intelligence-vs-output-speed)这类排行榜，比较不同模型的多个指标。

速度和延迟不仅取决于模型，还受模型所托管的提供商影响。如果你优先考虑输出速度，可选择专注于快速推理的提供商，如[groq](https://groq.com/)、[SambaNova](https://www.sambanova.com/)或[Cerebras](https://www.cerebras.ai/)。

### 关闭推理功能

推理会增加 token 消耗和延迟。如果你的具体用例不需要推理，建议关闭或最小化此功能。例如，在 GPT-5 和 GPT-5 mini 中，推荐将 `reasoningEffort` 提供商选项设置为 `'minimal'`。

```ts
// app/api/chat/route.ts
import { openai } from '@ai-sdk/openai'
import { toolDefinitions } from '@tiptap-pro/ai-toolkit-ai-sdk'
import { createAgentUIStreamResponse, ToolLoopAgent, UIMessage } from 'ai'

export async function POST(req: Request) {
  const { messages }: { messages: UIMessage[] } = await req.json()

  const agent = new ToolLoopAgent({
    model: openai('gpt-5-mini'),
    instructions: `你是一个可以编辑富文本文档的助手。`,
    tools: toolDefinitions(),
    // 将推理努力设置为 'minimal'
    providerOptions: {
      openai: {
        reasoningEffort: 'minimal',
      },
    },
  })

  return createAgentUIStreamResponse({
    agent,
    uiMessages: messages,
  })
}
```

### 为 AI 模型提供足够的上下文

在编辑文档之前，AI 模型需要先读取文档内容。通过将文档内容包含在用户消息或系统提示中，可以加快这一过程。

```ts
const toolkit = getAiToolkit(editor)

// 在发送用户消息之前，先读取文档开头内容
const { output } = toolkit.executeTool({
  toolName: 'tiptapRead',
  input: {
    from: 0,
  },
})

// 然后，在用户消息中包含文档内容
let userMessage = `将最后一段替换为一个短故事`

userMessage += `

---

用户已调用过 'tiptapRead' 工具，其返回内容如下：

${output}`

// 将用户消息发送给 AI 模型
```

这样，AI 模型无需再次调用 `tiptapRead` 工具读取文档，而可直接进入编辑阶段。

### 优先使用工作流而非智能体

[工作流](/content-ai/capabilities/ai-toolkit/workflows)比 AI 智能体更易实现。它们通常需要 AI 生成更少的 token，因此执行更快。此外，工作流通常可以配合更快、更小的模型使用。

AI 工具包内置了多种[内置工作流](/content-ai/capabilities/ai-toolkit/workflows)，可用于执行简单的文档编辑任务。