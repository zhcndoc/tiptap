---
title: "从零开始到打印就绪：页面 & DOCX 导出"
tags:
  - type: alpha
meta:
  title: 从零开始到打印就绪 | Tiptap Pages 文档
  description: 使用 Tiptap、Pages 和 DOCX 导出构建打印就绪编辑器的分步指南。
  category: Pages
sidebars:
  hideSecondary: true
---

import { Callout } from '@/components/ui/Callout'
import { CodeDemo } from '@/components/CodeDemo'

本指南将带你从头开始设置 Tiptap 编辑器，添加 Pages 扩展以实现分页和类似打印的布局，以及启用 DOCX 导出和导入，构建一个专业的打印就绪工作流。

<CodeDemo isPro src="https://feature-pages-extension--tiptap-pro.netlify.app/preview/extensions/pagesimportexportdocx" />

---

## 1. 安装 Tiptap 和核心依赖

首先，安装核心 Tiptap 包：

```bash
npm install @tiptap/core @tiptap/starter-kit
```

## 2. 添加 Pages 扩展

从 Tiptap Pro 注册表中安装 Pages 扩展：

```bash
npm install @tiptap-pro/extension-pages@alpha
```

> **提示：** 确保你有访问 Tiptap Pro 注册表的权限。有关设置，请参阅 [Pro 扩展指南](/guides/pro-extensions)。

## 3. 使用 Pages 设置你的编辑器

```js
import { Editor } from '@tiptap/core'
import StarterKit from '@tiptap/starter-kit'
import { Pages } from '@tiptap-pro/extension-pages'

const editor = new Editor({
  extensions: [
    StarterKit,
    Pages.configure({
      pageFormat: 'A4',
      headerHeight: 60,
      footerHeight: 60,
      pageGap: 40,
      header: '我的项目',
      footer: '第 {page} 页，共 {total} 页',
      pageBreakBackground: '#f8f8f8',
    }),
  ],
})
```

<Callout title="最佳实践" variant="info">
  早期使用 Pages 扩展，以确保你的文档结构和布局从一开始就保持一致。
</Callout>

## 4. 添加 DOCX 导出功能

安装 DOCX 导出扩展：

```bash
npm install @tiptap-pro/extension-export-docx
```

将其添加到你的编辑器：

```js
import { ExportDocx } from '@tiptap-pro/extension-export-docx'

const editor = new Editor({
  extensions: [
    StarterKit,
    Pages.configure({ /* ... */ }),
    ExportDocx,
  ],
})
```

### 4a. 配置 DOCX 导出（可选，但推荐）

你可以配置 DOCX 导出扩展来控制导出行为，处理结果，甚至覆盖样式。

```js
import { ExportDocx } from '@tiptap-pro/extension-export-docx'

const editor = new Editor({
  extensions: [
    StarterKit,
    Pages.configure({ /* ... */ }),
    ExportDocx.configure({
      // 这个回调是必需的！它接收导出的文件 (Blob、字符串等)
      onCompleteExport: (result) => {
        // 例如，在浏览器中触发下载：
        const blob = new Blob([result], {
          type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
        })
        const url = URL.createObjectURL(blob)
        const a = document.createElement('a')
        a.href = url
        a.download = 'document.docx'
        a.click()
        URL.revokeObjectURL(url)
      },
      // 可选：选择导出类型（'blob'、'string' 等）
      exportType: 'blob',
      // 可选：覆盖 DOCX 样式
      styleOverrides: {
        // 详见 DOCX 导出文档的完整样式选项
      },
      // 可选：如果你使用自定义 Tiptap 节点，可添加自定义节点转换器
      customNodes: [],
    }),
  ],
})
```

<Callout title="提示">
  <code>onCompleteExport</code> 回调是必需的。在这里处理导出的文件（例如下载、上传等）。
</Callout>

## 5. 导出你的文档

你现在可以将分页、打印就绪的文档导出为 DOCX：

```js
editor.commands.exportDocx()
```

<Callout title="提示">
  DOCX 导出扩展可无缝配合 Pages 使用。请注意，这并不意味着我们的 Pages 扩展与 Microsoft Word DOCX 文件之间可以完全一一对应，因为渲染引擎完全不同。
</Callout>

## 6. 将 DOCX 文件导入到你的编辑器

你也可以使用 ImportDocx 扩展直接导入 DOCX 文件到分页编辑器。这让用户可以加载 Word 文档并继续编辑，同时享有完整分页支持。

```js
import { ImportDocx } from '@tiptap-pro/extension-import-docx'

const editor = new Editor({
  extensions: [
    // ... 其他扩展 ...
    ImportDocx.configure({
      appId: 'your-app-id', // 你的 Convert 应用 ID
      token: 'your-jwt', // 你的认证令牌
      // 可选：自定义设置的端点与图片上传URL
      // endpoint: 'https://your-api-endpoint',
      // imageUploadCallbackUrl: 'https://your-upload-endpoint',
    }),
  ],
})
```

触发导入使用：

```js
editor.chain().importDocx({
  file, // 来自 <input type="file" /> 的 File 对象
  onImport(context) {
    if (context.error) {
      // 处理错误
      return
    }
    context.setEditorContent(context.content)
  },
}).run()
```

<Callout title="提示">
  使用 ImportDocx 扩展需要有效的 <code>appId</code> 和 <code>token</code>。有关设置，请参阅 [Pro 扩展指南](/guides/pro-extensions)。
</Callout>

---

## 后续步骤
- 探索更多 [Pages 选项](/pages/core-concepts/options) 以微调你的布局。
- 使用随 Pages 扩展附带的表格扩展，添加 [表格](/pages/core-concepts/limitations#tables) 以确保最佳兼容性。
- 结合其他 Tiptap Pro 扩展，打造功能完善的编辑器。

<Callout title="需要帮助？">
  查看剩余文档或联系我们的支持，获取更高级的工作流帮助！
</Callout> 
