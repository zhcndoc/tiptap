---
title: 拖拽手柄扩展
tags:
  - type: pro
meta:
  category: 编辑器
  title: 拖拽手柄扩展 | Tiptap 编辑器文档
  description: 通过拖拽手柄扩展，让你可以在 Tiptap 编辑器中自由拖动节点。在此文档中了解如何进行设置！
extension:
  name: 拖拽手柄
  description: 你是否曾经想在编辑器中拖动节点？其实我们也有这个需求。
  type: extension
  icon: GripVertical
  isPro: true
---

import { CodeDemo } from '@/components/CodeDemo'
import { Callout } from '@/components/ui/Callout'
import { Requirements, RequirementItem } from '@/components/Requirements'

<Requirements>
    <RequirementItem label="1. 激活试用或订阅">
        在你的账户中开始免费 [试用](https://cloud.tiptap.dev/v2/billing) 或订阅 [Tiptap 方案](https://cloud.tiptap.dev/v2/billing)。
    </RequirementItem>
    <RequirementItem label="2. 通过私有仓库安装">
        要安装此前端扩展，你需要通过 [设置指南](/guides/pro-extensions) 进行认证，访问 Tiptap 的私有 npm 注册表。
    </RequirementItem>
</Requirements>

你是否曾经希望在编辑器中自由拖动节点？其实我们也有这个需求 — 这就是为此设计的扩展。

`DragHandle` 扩展允许你轻松管理在编辑器中拖动节点。你可以定义自定义渲染函数、位置等。

<CodeDemo isPro path="/Extensions/DragHandle" />

## 安装

<Callout title="设置访问 Tiptap 私有仓库" variant="info">
  通过注册一个免费的 [Tiptap 账号](https://cloud.tiptap.dev/register)，并按照我们的 [访问指南](/guides/pro-extensions) 操作，即可集成此专业扩展到你的项目中。
</Callout>

```bash
npm install @tiptap-pro/extension-drag-handle@next
```

## 设置

### render

定义一个通过 tippy.js 定位的元素。这个元素会作为拖动节点时显示的手柄。

```js
DragHandle.configure({
  render: () => {
    const element = document.createElement('div')

    // 用于 CSS 插入图标的钩子
    element.classList.add('custom-drag-handle')

    return element
  },
})
```

### tippyOptions

tippy.js 的配置项。你可以传入 [tippy.js 文档](https://atomiks.github.io/tippyjs/v6/all-props/) 中的任何选项。

默认值：`undefined`

```js
DragHandle.configure({
  tippyOptions: {
    placement: 'left',
  },
})
```

### onNodeChange

当鼠标悬停在某个节点上时，返回该节点或 null。可以用来高亮悬停的节点。

默认值：`undefined`

```js
DragHandle.configure({
  onNodeChange: ({ node, editor, pos }) => {
    if (!node) {
      selectedNode = null
      return
    }
    // 处理悬停节点
    selectedNode = node
  },
})
```

## 命令

### lockDragHandle()

锁定拖拽手柄，使其保持可见且被锁定状态。如果此前手柄是可见的，保持可见直到解锁；如果之前是隐藏的，保持隐藏直到解锁。

适合在手柄内设置菜单，并希望菜单在鼠标悬停或不悬停时都保持可见。

```js
editor.commands.lockDragHandle()
```

### unlockDragHandle()

解锁拖拽手柄，恢复默认的可见性和行为。

```js
editor.commands.unlockDragHandle()
```

### toggleDragHandle()

切换拖拽手柄的锁定状态。若锁定，则解锁；若未锁定则锁定。

```js
editor.commands.toggleDragHandle()
```