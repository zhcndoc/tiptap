---
title: 数学扩展
extension:
  name: 数学
  link: https://github.com/ueberdosis/tiptap/tree/main/packages/extension-mathematics
  description: 这个扩展允许您的用户通过 LaTeX 编写和可视化数学公式。
  type: extension
  icon: SquareDivide
tags:
  - type: image
    src: https://img.shields.io/npm/v/@tiptap/extension-mathematics.svg?label=version
    url: https://www.npmjs.com/package/@tiptap/extension-mathematics
    label: 版本
  - type: image
    src: https://img.shields.io/npm/dm/@tiptap/extension-mathematics.svg
    url: https://npmcharts.com/compare/@tiptap/extension-mathematics?minimal=true
    label: 下载量
meta:
  title: 数学扩展 | Tiptap 编辑器文档
  description: 这个扩展允许您的用户通过 LaTeX 编写和可视化数学公式。了解如何在文档中进行设置！
  category: 编辑器
---

import { CodeDemo } from '@/components/CodeDemo'

这个扩展允许您在编辑器中编写和可视化甚至复杂的数学公式或方程。请注意，当前版本仍处于非常基础的阶段。

<CodeDemo path="/Extensions/Mathematics" />

## 安装

```bash
npm install @tiptap/extension-mathematics@beta katex
```

### 额外设置

您可以自由样式化渲染元素和编辑器输入。

**导入 KaTeX 样式（必需）。**

```js
import 'katex/dist/katex.min.css'
```

**以下类允许您选择和样式化数学装饰。有关示例，请参见此页面底部的演示代码。**

```css
/* 包含实际文本的装饰 */
.Tiptap-mathematics-editor {
  // …
}

/* KaTeX 渲染的容器 */
.Tiptap-mathematics-render {
  // …
}
```

### 控制何时渲染 LaTeX 装饰

默认情况下，当数学表达式不在代码块内时，会渲染 LaTeX 装饰。如果您想自定义此行为，可以通过将一个函数传递给 `shouldRender` 选项来实现。此函数应该返回一个布尔值，指示是否应渲染 LaTeX 装饰。

```js
import Mathematics from '@tiptap/extension-mathematics'

// [...]

Mathematics.configure({
  shouldRender: (state, pos, node) => {
    const $pos = state.doc.resolve(pos)
    return node.type.name === 'text' && $pos.parent.type.name !== 'codeBlock'
  },
})
```

您还可以导入默认的 `shouldRender` 函数以扩展默认行为：

```js
import Mathematics, { shouldRender } from '@tiptap/extension-mathematics'

// [...]

Mathematics.configure({
  shouldRender: (state, pos, node) => {
    // 这将禁用标题和代码块的渲染
    return shouldRender(state, pos, node) && node.type.name !== 'heading'
  },
})
```

## 设置

### regex

Tiptap 需要知道文本何时为数学。为此，正则表达式模式允许我们定义这种简写。例如，使用 TeX 简写 `$ … $`（见下方默认）。匹配项变为装饰 - 它们不会作为自己的节点或标记存储！

默认值: `/\$([^\$]*)\$/gi`

### katexOptions

对于数学排版，此扩展使用第三方库 [KaTeX](https://katex.org)。要调整其行为，您可以将 KaTeX 选项传递给它。所有选项请查阅 [这里](https://katex.org/docs/options.html)。

默认值: `undefined`

```js
import Mathematics from '@tiptap/extension-mathematics'

// [...]

Mathematics.configure({
  katexOptions: {
    maxSize: 300,
  },
})
```

### shouldRender

默认情况下，当数学表达式不在代码块内时，会渲染 LaTeX 装饰。如果您想自定义此行为，可以通过将一个函数传递给 `shouldRender` 选项来实现。此函数应该返回一个布尔值，指示是否应渲染 LaTeX 装饰。

默认值: `() => true`

```js
import Mathematics from '@tiptap/extension-mathematics'

// [...]

Mathematics.configure({
  shouldRender: (state, pos, node) => {
    const $pos = state.doc.resolve(pos)
    return node.type.name === 'text' && $pos.parent.type.name !== 'codeBlock'
  },
})
```